# CMSæ’ä»¶é›†æˆæ–¹æ¡ˆ - å®Œæ•´ç´¢å¼•

> æœ¬æ–‡æ¡£æ±‡æ€»æ‰€æœ‰CMSé›†æˆç›¸å…³çš„èµ„æºå’ŒæŒ‡å—ï¼Œå¸®åŠ©ä½ å¿«é€Ÿå®šä½éœ€è¦çš„å†…å®¹ã€‚

---

## ğŸ“š æ–‡æ¡£å¯¼èˆª

### 1ï¸âƒ£ å¿«é€Ÿå¼€å§‹ï¼ˆ10åˆ†é’Ÿï¼‰

| æ–‡æ¡£ | å†…å®¹ | ç”¨é€” |
|------|------|------|
| **CMS_QUICK_START.md** | 6æ­¥å¿«é€Ÿå®æ–½æŒ‡å— | ğŸ‘¨â€ğŸ’» **æ–°æ‰‹å¿…è¯»** - ä»0åˆ°1çš„å¿«é€Ÿè·¯å¾„ |
| **CMS_IMPLEMENTATION_CHECKLIST.md** | é€å¤©çš„ä»»åŠ¡æ¸…å• | âœ… é¡¹ç›®ç®¡ç† - è¿½è¸ªå¼€å‘è¿›åº¦ |

### 2ï¸âƒ£ æ¶æ„è®¾è®¡ï¼ˆ30åˆ†é’Ÿï¼‰

| æ–‡æ¡£ | å†…å®¹ | ç”¨é€” |
|------|------|------|
| **CMS_PLUGIN_INTEGRATION_PLAN.md** | å®Œæ•´æ¶æ„è®¾è®¡æ–¹æ¡ˆ | ğŸ—ï¸ **æ·±åº¦ç†è§£** - ç³»ç»Ÿè®¾è®¡å’Œå®ç°ç»†èŠ‚ |
| **CMS_ARCHITECTURE_COMPARISON.md** | ä¸‰ç§æ–¹æ¡ˆå¯¹æ¯”åˆ†æ | ğŸ” **æ–¹æ¡ˆé€‰æ‹©** - äº†è§£ä¼˜åŠ£å¹¶åšå‡ºå†³ç­– |

### 3ï¸âƒ£ æ•°æ®åº“å’Œæ•°æ®ï¼ˆ5åˆ†é’Ÿï¼‰

| æ–‡ä»¶ | å†…å®¹ | ç”¨é€” |
|------|------|------|
| **power-admin-server/db/migrations/002_init_cms_schema.sql** | CMSæ•°æ®åº“åˆå§‹åŒ–è„šæœ¬ | ğŸ—„ï¸ **å¼€ç®±å³ç”¨** - ä¸€é”®åˆ›å»ºæ‰€æœ‰è¡¨ |

---

## ğŸ¯ åœºæ™¯å¯¼èˆª

### åœºæ™¯1ï¼šæˆ‘æƒ³å¿«é€Ÿäº†è§£CMSæ’ä»¶èƒ½åšä»€ä¹ˆ

**æ¨èè·¯å¾„ï¼š**
```
CMS_QUICK_START.md
    â†“
CMS_ARCHITECTURE_COMPARISON.md (çœ‹"æœ€ç»ˆå»ºè®®"éƒ¨åˆ†)
```

**é¢„è®¡é˜…è¯»æ—¶é—´**: 15åˆ†é’Ÿ

---

### åœºæ™¯2ï¼šæˆ‘éœ€è¦å¼€å§‹å¼€å‘

**æ¨èè·¯å¾„ï¼š**
```
CMS_QUICK_START.md (ç¬¬ä¸€æ­¥å’Œç¬¬äºŒæ­¥)
    â†“
power-admin-server/db/migrations/002_init_cms_schema.sql (æ‰§è¡ŒSQL)
    â†“
CMS_PLUGIN_INTEGRATION_PLAN.md (å‚è€ƒå…·ä½“å®ç°)
    â†“
CMS_IMPLEMENTATION_CHECKLIST.md (é€ä¸ªå®Œæˆä»»åŠ¡)
```

**é¢„è®¡æ—¶é—´**: 2å‘¨

---

### åœºæ™¯3ï¼šæˆ‘éœ€è¦ç†è§£æ•´ä¸ªç³»ç»Ÿæ¶æ„

**æ¨èè·¯å¾„ï¼š**
```
CMS_ARCHITECTURE_COMPARISON.md
    â†“
CMS_PLUGIN_INTEGRATION_PLAN.md
    â†“
å®é™…ä»£ç å®ç°
```

**é¢„è®¡é˜…è¯»æ—¶é—´**: 1å°æ—¶

---

### åœºæ™¯4ï¼šæˆ‘è¢«åˆ†é…åˆ°æŸä¸ªå…·ä½“ä»»åŠ¡

**æ¨èè·¯å¾„ï¼š**
```
CMS_IMPLEMENTATION_CHECKLIST.md (å®šä½ä½ çš„ä»»åŠ¡)
    â†“
CMS_QUICK_START.md (å¯¹åº”çš„ç« èŠ‚)
    â†“
CMS_PLUGIN_INTEGRATION_PLAN.md (æŠ€æœ¯ç»†èŠ‚)
```

**é¢„è®¡æ—¶é—´**: å–å†³äºä»»åŠ¡å¤æ‚åº¦

---

## ğŸ“‹ æ ¸å¿ƒæ¦‚å¿µé€Ÿè§ˆ

### å…³é”®æœ¯è¯­

| æœ¯è¯­ | è§£é‡Š | ä¸¾ä¾‹ |
|------|------|------|
| **æ’ä»¶** | å¯ç‹¬ç«‹å¯ç”¨/ç¦ç”¨çš„åŠŸèƒ½æ¨¡å— | CMSä½œä¸ºæ’ä»¶é›†æˆåˆ°ä¸»ç³»ç»Ÿ |
| **å¯æ’æ‹”** | æ”¯æŒå®‰è£…/å¸è½½è€Œä¸å½±å“ä¸»ç³»ç»Ÿ | CMSç¦ç”¨åä¸»ç³»ç»Ÿæ­£å¸¸è¿è¡Œ |
| **èœå•æ³¨å…¥** | åŠ¨æ€å°†èœå•é¡¹æ·»åŠ åˆ°å·¦ä¾§èœå•æ  | CMSå¯ç”¨å"CMSç®¡ç†"èœå•å‡ºç° |
| **æƒé™éš”ç¦»** | CMSæƒé™ç‹¬ç«‹ç®¡ç†ï¼Œä¸ä¸ç³»ç»Ÿæƒé™æ··åˆ | CMSè§’è‰²(cms_admin/cms_editor) |
| **æ•°æ®éš”ç¦»** | CMSæ•°æ®è¡¨ä¸ç³»ç»Ÿè¡¨åˆ†ç¦» | cms_content, cms_categoryç­‰ |
| **APIç½‘å…³** | CMSé€šè¿‡APIä¸ä¸»ç³»ç»Ÿé€šä¿¡ | /api/cms/admin/contents |

### æ ¸å¿ƒæµç¨‹

```
1ï¸âƒ£ ç”¨æˆ·å¯ç”¨CMSæ’ä»¶
       â†“
2ï¸âƒ£ ç³»ç»Ÿåˆå§‹åŒ–CMSè¡¨ã€æƒé™ã€èœå•
       â†“
3ï¸âƒ£ CMSèœå•å‡ºç°åœ¨å·¦ä¾§èœå•æ 
       â†“
4ï¸âƒ£ ç”¨æˆ·è®¿é—®CMSåŠŸèƒ½(å†…å®¹ã€åˆ†ç±»ã€ç”¨æˆ·ç®¡ç†)
       â†“
5ï¸âƒ£ ç³»ç»Ÿæ£€æŸ¥ç”¨æˆ·CMSæƒé™
       â†“
6ï¸âƒ£ å…è®¸è®¿é—®(å¦‚æœæœ‰æƒé™) æˆ– è¿”å›403(å¦‚æœæ— æƒé™)
```

---

## ğŸ—ï¸ æ¶æ„å¿«è§ˆ

### é€‰æ‹©çš„æ–¹æ¡ˆï¼šé›†æˆå¼

```
ç³»ç»Ÿç™»å½•
    â†“
è®¤è¯(JWT)
    â†“
åŠ è½½èœå•(åŒ…æ‹¬CMSèœå•)
    â†“
ç”¨æˆ·å¯è®¿é—®:
â”œâ”€ ç³»ç»Ÿç®¡ç†(æƒé™/è§’è‰²/ç”¨æˆ·/èœå•)
â””â”€ CMSç®¡ç†(å†…å®¹/åˆ†ç±»/è®¿å®¢) â† æ–°å¢
```

### ä¸ºä»€ä¹ˆé€‰æ‹©é›†æˆå¼

| åŸå›  | è¯´æ˜ |
|------|------|
| âš¡ **å¿«** | 2å‘¨å¿«é€Ÿä¸Šçº¿ï¼Œä¸éœ€å¾®æœåŠ¡å¤æ‚æ€§ |
| ğŸ” **å®‰å…¨** | æƒé™ç®¡ç†æ— ç¼é›†æˆCasbin |
| ğŸ“¦ **ç®€å•** | å•ä¸€äºŒè¿›åˆ¶éƒ¨ç½² |
| ğŸš€ **æ€§èƒ½** | æ— ç½‘ç»œå»¶è¿Ÿï¼Œå†…å­˜ä¸­æƒé™éªŒè¯ |

---

## ğŸ“‚ æ–‡ä»¶ç»“æ„

### åç«¯

```
power-admin-server/
â”œâ”€â”€ api/
â”‚   â””â”€â”€ cms.api                    â† APIå®šä¹‰(æ–°å»º)
â”œâ”€â”€ internal/
â”‚   â”œâ”€â”€ handler/cms/               â† Handlerå±‚(æ–°å»º)
â”‚   â”‚   â”œâ”€â”€ cmscontenthandler.go
â”‚   â”‚   â”œâ”€â”€ cmscategoryhandler.go
â”‚   â”‚   â”œâ”€â”€ cmspublishhandler.go
â”‚   â”‚   â””â”€â”€ cmsusermanagementhandler.go
â”‚   â”œâ”€â”€ logic/cms/                 â† Logicå±‚(æ–°å»º)
â”‚   â”‚   â”œâ”€â”€ cmscontentlogic.go
â”‚   â”‚   â”œâ”€â”€ cmscategorylogic.go
â”‚   â”‚   â”œâ”€â”€ cmspublishlogic.go
â”‚   â”‚   â””â”€â”€ cmsusermanagementlogic.go
â”‚   â”œâ”€â”€ types/
â”‚   â”‚   â””â”€â”€ cms.go                 â† ç±»å‹å®šä¹‰(æ–°å»º)
â”‚   â””â”€â”€ svc/
â”‚       â””â”€â”€ servicecontext.go      â† ä¿®æ”¹:æ·»åŠ CMSPlugin
â”œâ”€â”€ db/
â”‚   â””â”€â”€ migrations/
â”‚       â””â”€â”€ 002_init_cms_schema.sql â† æ•°æ®åº“è„šæœ¬(æ–°å»º)
â””â”€â”€ pkg/
    â””â”€â”€ plugins/
        â””â”€â”€ cms-plugin.go          â† æ’ä»¶æ¡†æ¶(æ–°å»º)
```

### å‰ç«¯

```
power-admin-web/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ pages/cms/                 â† CMSé¡µé¢(æ–°å»º)
â”‚   â”‚   â”œâ”€â”€ content/
â”‚   â”‚   â”‚   â”œâ”€â”€ ContentList.vue
â”‚   â”‚   â”‚   â”œâ”€â”€ ContentDetail.vue
â”‚   â”‚   â”‚   â””â”€â”€ ContentForm.vue
â”‚   â”‚   â”œâ”€â”€ category/
â”‚   â”‚   â”‚   â”œâ”€â”€ CategoryList.vue
â”‚   â”‚   â”‚   â””â”€â”€ CategoryTree.vue
â”‚   â”‚   â”œâ”€â”€ users/
â”‚   â”‚   â”‚   â”œâ”€â”€ UserList.vue
â”‚   â”‚   â”‚   â””â”€â”€ UserForm.vue
â”‚   â”‚   â””â”€â”€ CmsLayout.vue
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â””â”€â”€ cms.ts                 â† APIè°ƒç”¨(æ–°å»º)
â”‚   â”œâ”€â”€ stores/
â”‚   â”‚   â””â”€â”€ cms.ts                 â† çŠ¶æ€ç®¡ç†(æ–°å»º)
â”‚   â””â”€â”€ router/
â”‚       â””â”€â”€ index.ts               â† ä¿®æ”¹:åŠ¨æ€æ³¨å†Œè·¯ç”±
```

---

## ğŸ”§ æ ¸å¿ƒå®ç°æ­¥éª¤

### åç«¯ï¼ˆ5å¤©ï¼‰

```
Day 1: æ•°æ®åº“è®¾è®¡
  â””â”€ æ‰§è¡Œ 002_init_cms_schema.sql
  
Day 2: APIå®šä¹‰å’Œç±»å‹å®šä¹‰
  â””â”€ åˆ›å»º api/cms.api
  â””â”€ åˆ›å»º internal/types/cms.go

Day 3: Handlerå’ŒLogicå®ç°
  â””â”€ å®ç° CRUD æ“ä½œ

Day 4: æ’ä»¶æ¡†æ¶å’Œæƒé™é›†æˆ
  â””â”€ å®ç° PluginInterface
  â””â”€ Casbinè§„åˆ™é›†æˆ

Day 5: è·¯ç”±æ³¨å†Œå’Œæµ‹è¯•
  â””â”€ åœ¨main.goä¸­æ³¨å†ŒCMSè·¯ç”±
  â””â”€ å•å…ƒæµ‹è¯•
```

### å‰ç«¯ï¼ˆ5å¤©ï¼‰

```
Day 1: APIæ¥å£å’ŒçŠ¶æ€ç®¡ç†
  â””â”€ åˆ›å»º src/api/cms.ts
  â””â”€ åˆ›å»º src/stores/cms.ts

Day 2: å†…å®¹ç®¡ç†é¡µé¢
  â””â”€ ContentList.vue
  â””â”€ ContentForm.vue

Day 3: åˆ†ç±»å’Œç”¨æˆ·ç®¡ç†
  â””â”€ CategoryList.vue
  â””â”€ UserList.vue

Day 4: èœå•å’Œè·¯ç”±é›†æˆ
  â””â”€ åŠ¨æ€åŠ è½½CMSèœå•
  â””â”€ æ³¨å†ŒCMSè·¯ç”±

Day 5: æµ‹è¯•å’Œä¼˜åŒ–
  â””â”€ åŠŸèƒ½æµ‹è¯•
  â””â”€ æƒé™éªŒè¯
  â””â”€ æ€§èƒ½ä¼˜åŒ–
```

---

## ğŸ“Š å…³é”®æ•°æ®ç»“æ„

### CMSå†…å®¹ (cms_content)

```typescript
interface CmsContent {
  id: number;
  title: string;              // æ–‡ç« æ ‡é¢˜
  content: string;            // æ–‡ç« å†…å®¹(HTML)
  excerpt: string;            // æ–‡ç« æ‘˜è¦
  categoryId: number;         // åˆ†ç±»ID
  authorId: number;           // ä½œè€…ID(ç³»ç»Ÿç”¨æˆ·)
  status: 1|2|3;              // 1:è‰ç¨¿ 2:å·²å‘å¸ƒ 3:å·²åˆ é™¤
  viewCount: number;          // æµè§ˆæ¬¡æ•°
  commentCount: number;       // è¯„è®ºæ•°
  createdAt: string;
  publishedAt?: string;
}
```

### CMSåˆ†ç±» (cms_category)

```typescript
interface CmsCategory {
  id: number;
  name: string;
  description: string;
  parentId?: number;          // æ”¯æŒå¤šçº§åˆ†ç±»
  sort: number;               // æ’åºå·
  status: 0|1;                // 0:ç¦ç”¨ 1:å¯ç”¨
}
```

### CMSå‰å°ç”¨æˆ· (cms_users)

```typescript
interface CmsUser {
  id: number;
  username: string;
  email: string;
  password: string;           // åŠ å¯†å­˜å‚¨
  nickname: string;
  avatar?: string;
  status: 0|1|2;              // 1:æ­£å¸¸ 0:ç¦ç”¨ 2:å°ç¦
  createdAt: string;
}
```

---

## ğŸ”’ æƒé™ç®¡ç†

### CMSè§’è‰²

| è§’è‰² | æƒé™ | è¯´æ˜ |
|------|------|------|
| **cms_admin** | æ‰€æœ‰æ“ä½œ | CMSç®¡ç†å‘˜ï¼Œå…¨æƒé™ |
| **cms_editor** | C/R/U | CMSç¼–è¾‘ï¼Œå¯åˆ›å»º/ç¼–è¾‘/å‘å¸ƒ |
| **cms_viewer** | R | CMSæŸ¥çœ‹è€…ï¼Œä»…æŸ¥çœ‹ |

### æƒé™è§„åˆ™ç¤ºä¾‹

```sql
-- CMSç®¡ç†å‘˜å¯æ‰§è¡Œæ‰€æœ‰æ“ä½œ
INSERT INTO casbin_rule (ptype, v0, v1, v2) VALUES
('p', 'cms_admin', '/api/cms/admin/contents', 'GET'),
('p', 'cms_admin', '/api/cms/admin/contents', 'POST'),
('p', 'cms_admin', '/api/cms/admin/contents', 'PUT'),
('p', 'cms_admin', '/api/cms/admin/contents', 'DELETE');

-- CMSç¼–è¾‘å¯åˆ›å»ºå’Œç¼–è¾‘ï¼Œä½†ä¸èƒ½åˆ é™¤
INSERT INTO casbin_rule (ptype, v0, v1, v2) VALUES
('p', 'cms_editor', '/api/cms/admin/contents', 'GET'),
('p', 'cms_editor', '/api/cms/admin/contents', 'POST'),
('p', 'cms_editor', '/api/cms/admin/contents', 'PUT');
```

---

## ğŸš€ å¿«é€Ÿéƒ¨ç½²

### 1ï¸âƒ£ åˆå§‹åŒ–æ•°æ®åº“

```bash
# è¿›å…¥æ•°æ®åº“å®¢æˆ·ç«¯
mysql -u root -p power_admin

# æ‰§è¡Œåˆå§‹åŒ–è„šæœ¬
source power-admin-server/db/migrations/002_init_cms_schema.sql;
```

### 2ï¸âƒ£ ç¼–è¯‘åç«¯

```bash
cd power-admin-server
go build -o power-admin.exe ./cmd/api/main.go
./power-admin.exe
```

### 3ï¸âƒ£ å¯åŠ¨å‰ç«¯

```bash
cd power-admin-web
npm install
npm run dev
```

### 4ï¸âƒ£ æµ‹è¯•

è®¿é—® http://localhost:5173ï¼Œç™»å½•ååº”è¯¥èƒ½çœ‹åˆ°å·¦ä¾§èœå•ä¸­çš„"CMSç®¡ç†"é¡¹ã€‚

---

## âš ï¸ å¸¸è§é—®é¢˜

### Q1: CMSå’Œç³»ç»Ÿç”¨æˆ·æ˜¯åŒä¸€ä¸ªå—ï¼Ÿ

**A**: ä¸æ˜¯ã€‚ç³»ç»Ÿæœ‰ä¸¤ç§ç”¨æˆ·ï¼š
- **ç³»ç»Ÿç”¨æˆ·** (admin_users): ç®¡ç†åå°çš„ç®¡ç†å‘˜
- **CMSç”¨æˆ·** (cms_users): CMSå‰å°çš„è®¿å®¢

ç³»ç»Ÿç”¨æˆ·é€šè¿‡CMSè§’è‰²(cms_admin/cms_editor)æ¥è®¿é—®CMSåŠŸèƒ½ã€‚

### Q2: CMSå¯ä»¥ç¦ç”¨å—ï¼Ÿ

**A**: å¯ä»¥ã€‚æ›´æ–° `plugin_status` è¡¨ä¸­çš„ `enabled` å­—æ®µä¸º0ï¼Œç„¶åé‡å¯åç«¯æœåŠ¡ã€‚æ‰€æœ‰CMSèœå•å’ŒåŠŸèƒ½å°†è‡ªåŠ¨éšè—ã€‚

### Q3: å¦‚ä½•å®ç°ç”¨æˆ·å¯¹CMSå†…å®¹çš„æƒé™æ§åˆ¶ï¼Ÿ

**A**: ä½¿ç”¨Casbinè§„åˆ™ï¼š
```go
// æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å¯ä»¥è®¿é—®CMS
hasPermission, _ := enforcer.Enforce(
    userId,                        // ç”¨æˆ·ID
    "/api/cms/admin/contents",    // èµ„æº
    "GET",                         // æ“ä½œ
)
```

### Q4: æ€æ ·æ”¯æŒå¤šä¸ªæ’ä»¶ï¼Ÿ

**A**: æ¯ä¸ªæ’ä»¶éƒ½å®ç°ç›¸åŒçš„ `PluginInterface` æ¥å£ï¼Œç„¶åé€šè¿‡æ’ä»¶ç®¡ç†å™¨ï¼ˆPluginManagerï¼‰ç»Ÿä¸€ç®¡ç†ã€‚

---

## ğŸ“– æ·±å…¥å­¦ä¹ 

### æ¨èé˜…è¯»é¡ºåº

```
1. CMS_QUICK_START.md (å¿«é€Ÿäº†è§£)
   â†“
2. CMS_ARCHITECTURE_COMPARISON.md (äº†è§£è®¾è®¡å†³ç­–)
   â†“
3. CMS_PLUGIN_INTEGRATION_PLAN.md (æ·±å…¥æŠ€æœ¯ç»†èŠ‚)
   â†“
4. CMS_IMPLEMENTATION_CHECKLIST.md (æŒ‰æ­¥éª¤å®æ–½)
   â†“
5. å¼€å§‹ç¼–ç !
```

### ç›¸å…³æŠ€æœ¯æ–‡æ¡£

- **Go-Zeroæ¡†æ¶**: [å®˜æ–¹æ–‡æ¡£](https://go-zero.dev/)
- **Casbin RBAC**: [å®˜æ–¹æ–‡æ¡£](https://casbin.org/docs/get-started)
- **Vue3 + TypeScript**: [å®˜æ–¹æ–‡æ¡£](https://vuejs.org/)
- **MySQLè®¾è®¡æœ€ä½³å®è·µ**: [MySQLå®˜æ–¹æ–‡æ¡£](https://dev.mysql.com/)

---

## ğŸ¤ è·å–å¸®åŠ©

| é—®é¢˜ç±»å‹ | æŸ¥çœ‹æ–‡æ¡£ |
|---------|--------|
| å¦‚ä½•å¿«é€Ÿå¼€å§‹ | CMS_QUICK_START.md |
| æ¶æ„è®¾è®¡é—®é¢˜ | CMS_PLUGIN_INTEGRATION_PLAN.md |
| æ–¹æ¡ˆå¯¹æ¯” | CMS_ARCHITECTURE_COMPARISON.md |
| ä»»åŠ¡ç®¡ç† | CMS_IMPLEMENTATION_CHECKLIST.md |
| æƒé™é…ç½® | CMS_PLUGIN_INTEGRATION_PLAN.md (ç¬¬äº”éƒ¨åˆ†) |
| æ•°æ®åº“ | power-admin-server/db/migrations/002_init_cms_schema.sql |

---

## ğŸ“ æ ¸å¯¹æ¸…å•

åœ¨å¼€å§‹å¼€å‘ä¹‹å‰ï¼Œç¡®ä¿ä½ ï¼š

- [ ] å·²é˜…è¯» CMS_QUICK_START.md
- [ ] ç†è§£äº†é›†æˆå¼æ¶æ„çš„ä¼˜åŠ¿
- [ ] äº†è§£CMSçš„æ ¸å¿ƒåŠŸèƒ½(å†…å®¹/åˆ†ç±»/ç”¨æˆ·)
- [ ] çŸ¥é“å¦‚ä½•æ‰§è¡Œæ•°æ®åº“è„šæœ¬
- [ ] å‡†å¤‡å¥½åç«¯å’Œå‰ç«¯å¼€å‘ç¯å¢ƒ
- [ ] æœ‰ä»»ä½•é—®é¢˜éƒ½æŸ¥é˜…äº†ç›¸åº”çš„æ–‡æ¡£

---

**æœ€åæ›´æ–°**: 2024å¹´  
**ç‰ˆæœ¬**: 1.0  
**çŠ¶æ€**: âœ… å®Œæˆ

